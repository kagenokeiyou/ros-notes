# 客户端库

客户端库是允许用户实现其 ROS 2 代码的 API。通过客户端库，用户可以访问 ROS 2 的概念，如节点、主题、服务等。客户端库提供多种编程语言，以便用户可以在最适合其应用的编程语言中编写 ROS 2 代码。例如，您可能更喜欢用 Python 编写可视化工具，因为这样可以更快地进行原型迭代，而对于系统效率相关的部分，节点可能更适合用 C++实现。

使用不同客户端库编写的节点能够相互共享消息，因为所有客户端库都实现了代码生成器，为用户提供与相应语言中的 ROS 2 接口文件交互的能力。

除了特定语言的通信工具，客户端库还向用户展示了使 ROS 成为“ROS”的核心功能。例如，以下是通过客户端库通常可以访问的功能列表：

- 名称和命名空间
- 时间（真实或模拟）
- 参数
- 控制台日志记录
- 线程模型
- 进程内通信

## 支持的客户端库

### rclcpp

ROS C++ 客户端库（`rclcpp`）是面向用户、符合 C++ 习惯的接口，它提供了创建节点、发布者和订阅者等所有 ROS 客户端功能。 `rclcpp` 基于 `rcl` 和 `rosidl` API 构建，设计用于与 `rosidl_generator_cpp` 生成的 C++ 消息一起使用。

`rclcpp` 利用 C++ 和 C++17 的所有特性，使接口尽可能易于使用，但由于它重用了 `rcl` 中的实现，因此能够与其他使用 `rcl` API 的客户端库保持一致的行为。

### rclpy

ROS Python 客户端库（`rclpy`）是 C++ 客户端库的 Python 版本。与 C++ 客户端库一样， `rclpy` 也是基于 `rcl` C API 实现的。该接口提供了符合 Python 习惯的 Python 体验，使用原生 Python 类型和模式，如列表和上下文对象。通过在实现中使用 `rcl` API，它在功能一致性和行为方面与其他客户端库保持一致。除了为 `rcl` API 提供符合 Python 习惯的绑定以及为每个消息提供 Python 类之外，Python 客户端库还负责执行模型，使用 `threading.Thread` 或类似工具来运行 `rcl` API 中的函数。

像 C++一样，它为用户交互的每个 ROS 消息生成自定义 Python 代码，但与 C++不同，它最终将原生 Python 消息对象转换为消息的 C 版本。所有操作都在消息的 Python 版本上进行，直到它们需要传递到 rcl 层，此时它们会被转换为纯 C 版本的消息，以便传递到 `rcl` C API。当在同一进程中通信发布者和订阅者时，如果可能，会避免这种情况，以减少转换进出 Python。

## 社区维护

虽然 C++和 Python 客户端库由 ROS 2 核心团队维护，但 ROS 2 社区成员维护了额外的客户端库：

- [Ada](https://github.com/ada-ros/ada4ros2) 这是一个包含包（与 `rcl` 绑定，消息生成器，与 `tf2` 绑定，示例和教程）的集合，允许为 ROS 2 编写 Ada 应用程序。
- [C](https://github.com/ros2/rclc) `rclc` 并未在 `rcl` 之上添加一层，而是补充 `rcl`，使 `rcl` + `rclc` 成为功能完整的 C 客户端库。
- [JVM and Android](https://github.com/ros2-java) Java 和 Android 的 ROS 2 绑定。
- [.NET Core, UWP and C#](https://github.com/esteve/ros2_dotnet) 这是一个用于为.NET Core 和.NET Standard 编写 ROS 2 应用程序的项目集合（绑定、代码生成器、示例等）。
- [Node.js](https://www.npmjs.com/package/rclnodejs) `rclnodejs` 是一个用于 ROS 2 的 Node.js 客户端。它为 ROS 2 编程提供了一个简单易用的 JavaScript API。
- [Rust](https://github.com/ros2-rust/ros2_rust) 这是一个项目集合（包括 `rclrs` 客户端库、代码生成器、示例等），使开发者能够在 Rust 中编写 ROS 2 应用程序。
- [Flutter and Dart](https://github.com/rcldart) 用于 ROS 2 的 Flutter 和 Dart 绑定。

## 通用功能：`rcl`

客户端库中的大部分功能并非特定于客户端库的编程语言。例如，参数的行为和命名空间的逻辑在所有编程语言中应该是理想的统一。由于这个原因，客户端库不是从零开始实现通用功能，而是使用一个通用的 ROS 客户端库（RCL）接口，该接口实现了与语言无关的 ROS 概念的逻辑和行为。因此，客户端库只需要通过外部函数接口将通用功能包装在 RCL 中。这使客户端库更加精简，也更容易开发。出于这个原因，通用的 RCL 功能以 C 接口的形式暴露出来，因为 C 语言通常是客户端库最容易进行包装的语言。

除了使客户端库轻量化外，拥有公共核心的优势还在于不同语言之间的行为更加一致。如果对核心 RCL 中的功能逻辑/行为进行任何更改——例如命名空间——所有使用 RCL 的客户端库都将反映这些更改。此外，拥有公共核心意味着在修复错误时，维护多个客户端库的工作量会减少。

## 特定语言的功能

需要特定语言功能/属性的客户端库概念并未在 RCL 中实现，而是在每个客户端库中实现。例如，`spin` 函数使用的线程模型将具有针对客户端库语言的特定实现。
